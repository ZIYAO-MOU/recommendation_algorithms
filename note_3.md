# 推荐系统之矩阵分解

###  隐语义模型与矩阵分解

协同过滤中衍生出矩阵分解模型(Matrix Factorization,MF)或者叫隐语义模型,  就是在协同过滤共现矩阵的基础上， 使用**更稠密的隐向量**表示用户和物品， 挖掘用户和物品的隐含兴趣和隐含特征， 在一定程度上**弥补协同过滤模型处理稀疏矩阵能力不足的问题。**

**通过隐含特征（latent factor）联系用户兴趣和物品（item）， 基于用户的行为找出潜在的主题和分类， 然后对item进行自动聚类，划分到不同类别/主题(用户的兴趣)**。

> 如果是隐语义模型的话， 它会先通过一些角度把用户兴趣和这些书归一下类， 当来了用户之后， 首先得到他的兴趣分类， 然后从这个分类中挑选他可能喜欢的书籍。

把用户的相似性和物品的相似性通过了一个叫做隐向量的方式进行表达

矩阵分解算法将 m×n 维的共享矩阵 R 分解成 m×k 维的用户矩阵 U 和 k×n 维的物品矩阵 V 相乘的形式。 其中 m 是用户数量， n 是物品数量， **k 是隐向量维度**， 也就是隐含特征个数， 只不过这里的隐含特征变得不可解释了， 即我们不知道具体含义了， 要模型自己去学。 **k 的大小决定了隐向量表达能力的强弱， k 越大， 表达信息就越强， 理解起来就是把用户的兴趣和物品的分类划分的越具体。**

![img](file:///C:\Users\15905\AppData\Roaming\Tencent\Users\546550064\QQ\WinTemp\RichOle\_44@[HTR_6@LVPHAN}P5RP0.png)

那么如果有了用户矩阵和物品矩阵的话， 我们就知道了如果想计算用户 u 对物品 i 的评分， 只需要

![img](file:///C:\Users\15905\AppData\Roaming\Tencent\Users\546550064\QQ\WinTemp\RichOle\00WB4N]$U]B9@NO%1~IQ%JK.png)

###  Basic SVD

**把求解上面两个矩阵的参数问题转换成一个最优化问题， 可以通过训练集里面的观察值利用最小化来学习用户矩阵和物品矩阵**。

![img](file:///C:\Users\15905\AppData\Roaming\Tencent\Users\546550064\QQ\WinTemp\RichOle\H{R8NRLK[~[K4{W5~_1WE@I.png)

**如图所示,pu^Tqi是随机初始化的用户矩阵和物品矩阵，但是和真实值存在误差，误差项累积即可求得总的误差**

计算梯度后（将sse变为1/2，即可得到梯度更新公式）

![img](file:///C:\Users\15905\AppData\Roaming\Tencent\Users\546550064\QQ\WinTemp\RichOle\F6SX6$DY852H@KBJ0B8`KLU.png)

**当rui考虑其他因素加了偏置项， 来消除用户和物品打分的偏差**

 Netfix Prize中提出了另一种LFM，  即预测公式如下：

![img](file:///C:\Users\15905\AppData\Roaming\Tencent\Users\546550064\QQ\WinTemp\RichOle\33LU2}0_HZ8$C]V1V6}NVYP.png)

这个预测公式加入了3项偏置 μ,bu,bi , 作用如下：

- μ : 训练集中所有记录的评分的**全局平均数**。 在不同网站中， 因为网站定位和销售物品不同， 网站的整体评分分布也会显示差异。 比如有的网站中用户就喜欢打高分， 有的网站中用户就喜欢打低分。 而全局平均数可以表示网站本身对用户评分的影响。
- bu : **用户偏差系数， 可以使用用户 u 给出的所有评分的均值， 也可以当做训练参数。** 这一项表示了用户的评分习惯中和物品没有关系的那种因素。 比如有些用户比较苛刻， 对什么东西要求很高， 那么他评分就会偏低， 而有些用户比较宽容， 对什么东西都觉得不错， 那么评分就偏高
- bi : **物品偏差系数， 可以使用物品 i 收到的所有评分的均值， 也可以当做训练参数。** 这一项表示了物品接受的评分中和用户没有关系的因素。 比如有些物品本身质量就很高， 因此获得的评分相对比较高， 有的物品本身质量很差， 因此获得的评分相对较低。

用jupyter进行了编码实践

![img](file:///C:\Users\15905\AppData\Roaming\Tencent\Users\546550064\QQ\WinTemp\RichOle\CG`UQJ~TG_5ZZA{CCF%MCX3.png)

### RSVD 

![image](https://img-blog.csdn.net/20150124144759847)

### ASVD

全称叫Asymmetric-SVD，即非对称SVD，其预测式子为

![image](https://img-blog.csdn.net/20150124150011078)
